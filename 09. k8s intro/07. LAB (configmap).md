# K8S ConfigMap

**Важно**: если вы **не подняли** локальный registry (`registry.local:5000`), то во всех yml замените `image` на:
* `ghcr.io/coursar/docker-27.10.25/app-boot:1.0.0` для версии 1.0.0
* `ghcr.io/coursar/docker-27.10.25/app-boot:2.0.0` для версии 2.0.0

В противном случае, убедитесь, что ваш локальный реестр доступен и содержит необходимые образа:

```sh
docker container ls | grep registry

skopeo list-tags docker://registry.local:5000/library/app-boot
```

Ожидается вывод:

```json
{
    "Repository": "registry.local:5000/library/app-boot",
    "Tags": [
        "1.0.0",
        "2.0.0"
    ]
}
```

## Шаг 1. Создание ConfigMap

Используя официальную документацию или `kubectl explain` создайте ресурс `ConfigMap`, который позволяет хранить файл со следующим содержимым:

```properties
management.info.env.enabled=true
info.app.instance-id=${random.uuid}
```

## Шаг 2. Использование ConfigMap

Без модификации существующих образов, модифицируйте спецификацию Pod'а в Deployment'е так, чтобы "файл" из ConfigMap'а отображался в `/app/application.properties` внутри контейнера

После этого разверните Deployment вместе с сервисом

Отправьте запрос через curl и убедитесь, что теперь в `/actuator/info` присутствует `instance-id`:

```sh
curl -v http://SERVICE_IP:8080/actuator/info | jq .
```

Удалите созданные ресурсы
